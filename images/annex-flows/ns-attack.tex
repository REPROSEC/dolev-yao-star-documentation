
        \begin{tikzpicture}[]
        \pgfdeclarelayer{arrows}
        \pgfdeclarelayer{groups}
        \pgfdeclarelayer{markers}
        \pgfsetlayers{groups,arrows,main,markers}
        
        % MATRIX
        \matrix [column sep={0.3\linewidth,between origins}, row sep=0.25ex]
        {
        \node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-0){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-0){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-0){};\node[annex_matrix_dummy_height,minimum height=5ex,anchor=center]{};\node[annex_matrix_dummy_height,minimum height=5ex,anchor=center]{};\node[annex_matrix_dummy_height,minimum height=5ex,anchor=center]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-1){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-1){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-1){};\node[annex_matrix_dummy_height,minimum height=3ex,anchor=center]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-2){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-2){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-2){};\node[annex_matrix_dummy_height,minimum height=2ex+2ex,anchor=south,yshift=-1ex]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-3){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-3){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-3){};\node[annex_matrix_dummy_height,minimum height=2ex+2ex,anchor=south,yshift=-1ex]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-4){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-4){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-4){};\node[annex_matrix_dummy_height,minimum height=3ex,anchor=center]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-5){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-5){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-5){};\node[annex_matrix_dummy_height,minimum height=2ex+2ex,anchor=south,yshift=-1ex]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-6){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-6){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-6){};\node[annex_matrix_dummy_height,minimum height=2ex+2ex,anchor=south,yshift=-1ex]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-7){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-7){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-7){};\node[annex_matrix_dummy_height,minimum height=2ex+2ex,anchor=south,yshift=-1ex]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-8){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-8){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-8){};\node[annex_matrix_dummy_height,minimum height=2ex+2ex,anchor=south,yshift=-1ex]{};\\
\node[annex_matrix_node,inner sep=0,outer sep=0](pos-0-9){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-1-9){}; &\node[annex_matrix_node,inner sep=0,outer sep=0](pos-2-9){};\node[annex_matrix_dummy_height,minimum height=5ex,anchor=center]{};\node[annex_matrix_dummy_height,minimum height=5ex,anchor=center]{};\node[annex_matrix_dummy_height,minimum height=5ex,anchor=center]{};\\
};

% MAIN LAYER

% drawing node of type Protocol in matrix line 0 with attributes: {'annexid': 'Protocol_1', 'parties': [<Party_2>, <Party_3>, <Party_4>], 'steps': [<Parallel_5>, <Action_6>, <GenericMessage_7>, <GenericMessage_8>, <Action_9>, <GenericMessage_10>, <GenericMessage_11>, <GenericMessage_12>, <GenericMessage_13>, <Parallel_14>], 'options': {'colsep': '0.3\\linewidth', 'rowsep': '0.25ex', 'enumerate': '\\setcounter{protostep}{%d}\\protostep{ns-attack:%s} ', 'styles': [], 'tex_intro': ''}, 'line': 0, 'length': 10, 'columns': [{'num': 0}, {'num': 1}, {'num': 2}], 'protocol': <Protocol_1>}


% drawing node of type Parallel in matrix line 0 with attributes: {'annexid': 'Parallel_5', 'steps': [<StartParty_15>, <StartParty_16>, <StartParty_17>], 'line': 0, 'length': 1, 'protocol': <Protocol_1>}


% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_15', 'party': <Party_2>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_15_0'], 'node_name': 'StartParty_15_0', 'end': <EndParty_18>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}
\node[name=StartParty_15_0,annex_start_party_box,] at (pos-0-0) {Alice};

% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_16', 'party': <Party_3>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_16_0'], 'node_name': 'StartParty_16_0', 'end': <EndParty_20>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}
\node[name=StartParty_16_0,annex_start_party_box,] at (pos-1-0) {Eve};

% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_17', 'party': <Party_4>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_17_0'], 'node_name': 'StartParty_17_0', 'end': <EndParty_19>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}
\node[name=StartParty_17_0,annex_start_party_box,] at (pos-2-0) {Bob};

% drawing node of type Action in matrix line 1 with attributes: {'annexid': 'Action_6', 'party': <Party_2>, 'id': 'gen-nonce', 'label': 'Generate a new nonce $n_A$', 'line': 1, 'protocol': <Protocol_1>, '_counter': 1, 'node_name_counter': 1, '_affecting_nodes': ['Action_6_0'], 'node_name': 'Action_6_0'}
\node[annex_action,name=Action_6_0] at (pos-0-1) {\setcounter{protostep}{0}\protostep{ns-attack:gen-nonce} \contour{white}{Generate a new nonce $n_A$}};

% drawing node of type GenericMessage in matrix line 2 with attributes: {'annexid': 'GenericMessage_7', 'src': <Party_2>, 'dest': <Party_3>, 'caption': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$', 'id': 'msg1-a-e', 'line': 2, 'protocol': <Protocol_1>, '_counter': 2, 'text_above': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$', 'text_below': '', '_affecting_nodes': ['pos-0-2', 'pos-1-2']}


% drawing node of type GenericMessage in matrix line 3 with attributes: {'annexid': 'GenericMessage_8', 'src': <Party_3>, 'dest': <Party_4>, 'caption': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$', 'line': 3, 'protocol': <Protocol_1>, '_counter': 3, 'text_above': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$', 'text_below': '', '_affecting_nodes': ['pos-1-3', 'pos-2-3']}


% drawing node of type Action in matrix line 4 with attributes: {'annexid': 'Action_9', 'party': <Party_4>, 'id': 'gen-nonce', 'label': 'Generate a new nonce $n_B$', 'line': 4, 'protocol': <Protocol_1>, '_counter': 4, 'node_name_counter': 1, '_affecting_nodes': ['Action_9_0'], 'node_name': 'Action_9_0'}
\node[annex_action,name=Action_9_0] at (pos-2-4) {\setcounter{protostep}{3}\protostep{ns-attack:gen-nonce} \contour{white}{Generate a new nonce $n_B$}};

% drawing node of type GenericMessage in matrix line 5 with attributes: {'annexid': 'GenericMessage_10', 'src': <Party_4>, 'dest': <Party_3>, 'caption': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'id': 'nonces-bob-eve', 'line': 5, 'protocol': <Protocol_1>, '_counter': 5, 'text_above': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'text_below': '', '_affecting_nodes': ['pos-2-5', 'pos-1-5']}


% drawing node of type GenericMessage in matrix line 6 with attributes: {'annexid': 'GenericMessage_11', 'src': <Party_3>, 'dest': <Party_2>, 'caption': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'line': 6, 'protocol': <Protocol_1>, '_counter': 6, 'text_above': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'text_below': '', '_affecting_nodes': ['pos-1-6', 'pos-0-6']}


% drawing node of type GenericMessage in matrix line 7 with attributes: {'annexid': 'GenericMessage_12', 'src': <Party_2>, 'dest': <Party_3>, 'caption': '$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$', 'line': 7, 'protocol': <Protocol_1>, '_counter': 7, 'text_above': '$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$', 'text_below': '', '_affecting_nodes': ['pos-0-7', 'pos-1-7']}


% drawing node of type GenericMessage in matrix line 8 with attributes: {'annexid': 'GenericMessage_13', 'src': <Party_3>, 'dest': <Party_4>, 'caption': '$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$', 'line': 8, 'protocol': <Protocol_1>, '_counter': 8, 'text_above': '$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$', 'text_below': '', '_affecting_nodes': ['pos-1-8', 'pos-2-8']}


% drawing node of type Parallel in matrix line 9 with attributes: {'annexid': 'Parallel_14', 'steps': [<EndParty_18>, <EndParty_19>, <EndParty_20>], 'line': 9, 'length': 1, 'protocol': <Protocol_1>}


% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_18', 'party': <Party_2>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_18_0'], 'node_name': 'EndParty_18_0'}
\node[name=EndParty_18_0,annex_end_party_box,] at (pos-0-9) {Alice};

% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_19', 'party': <Party_4>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_19_0'], 'node_name': 'EndParty_19_0'}
\node[name=EndParty_19_0,annex_end_party_box,] at (pos-2-9) {Bob};

% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_20', 'party': <Party_3>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_20_0'], 'node_name': 'EndParty_20_0'}
\node[name=EndParty_20_0,annex_end_party_box,] at (pos-1-9) {Eve};


% ARROWS LAYER

\begin{pgfonlayer}{arrows}% drawing node of type Protocol in matrix line 0 with attributes: {'annexid': 'Protocol_1', 'parties': [<Party_2>, <Party_3>, <Party_4>], 'steps': [<Parallel_5>, <Action_6>, <GenericMessage_7>, <GenericMessage_8>, <Action_9>, <GenericMessage_10>, <GenericMessage_11>, <GenericMessage_12>, <GenericMessage_13>, <Parallel_14>], 'options': {'colsep': '0.3\\linewidth', 'rowsep': '0.25ex', 'enumerate': '\\setcounter{protostep}{%d}\\protostep{ns-attack:%s} ', 'styles': [], 'tex_intro': ''}, 'line': 0, 'length': 10, 'columns': [{'num': 0}, {'num': 1}, {'num': 2}], 'protocol': <Protocol_1>}


% drawing node of type Parallel in matrix line 0 with attributes: {'annexid': 'Parallel_5', 'steps': [<StartParty_15>, <StartParty_16>, <StartParty_17>], 'line': 0, 'length': 1, 'protocol': <Protocol_1>}


% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_15', 'party': <Party_2>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_15_0'], 'node_name': 'StartParty_15_0', 'end': <EndParty_18>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}
\draw[annex_lifeline] (pos-0-0) -- (pos-0-9);

% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_16', 'party': <Party_3>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_16_0'], 'node_name': 'StartParty_16_0', 'end': <EndParty_20>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}
\draw[annex_lifeline] (pos-1-0) -- (pos-1-9);

% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_17', 'party': <Party_4>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_17_0'], 'node_name': 'StartParty_17_0', 'end': <EndParty_19>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}
\draw[annex_lifeline] (pos-2-0) -- (pos-2-9);

% drawing node of type Action in matrix line 1 with attributes: {'annexid': 'Action_6', 'party': <Party_2>, 'id': 'gen-nonce', 'label': 'Generate a new nonce $n_A$', 'line': 1, 'protocol': <Protocol_1>, '_counter': 1, 'node_name_counter': 1, '_affecting_nodes': ['Action_6_0'], 'node_name': 'Action_6_0', 'tex_id': '\\setcounter{protostep}{0}\\protostep{ns-attack:gen-nonce} ', 'tikz_extra_style': ''}


% drawing node of type GenericMessage in matrix line 2 with attributes: {'annexid': 'GenericMessage_7', 'src': <Party_2>, 'dest': <Party_3>, 'caption': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$', 'id': 'msg1-a-e', 'line': 2, 'protocol': <Protocol_1>, '_counter': 2, 'text_above': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$', 'text_below': '', '_affecting_nodes': ['pos-0-2', 'pos-1-2']}
%% draw message
            \draw[annex_message] (pos-0-2) to node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:msg1-a-e}](GenericMessage_7_0){\setcounter{protostep}{1}\protostep{ns-attack:msg1-a-e} \contour{white}{$\{\text{Alice}, n_A\}^\text{a}_{k_\text{Eve}}$}}  (pos-1-2); 

% drawing node of type GenericMessage in matrix line 3 with attributes: {'annexid': 'GenericMessage_8', 'src': <Party_3>, 'dest': <Party_4>, 'caption': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$', 'line': 3, 'protocol': <Protocol_1>, '_counter': 3, 'text_above': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$', 'text_below': '', '_affecting_nodes': ['pos-1-3', 'pos-2-3']}
%% draw message
            \draw[annex_message] (pos-1-3) to node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_8_0){\setcounter{protostep}{2}\protostep{ns-attack:GenericMessage_8} \contour{white}{$\{\text{Alice}, n_A\}^\text{a}_{k_\text{Bob}}$}}  (pos-2-3); 

% drawing node of type Action in matrix line 4 with attributes: {'annexid': 'Action_9', 'party': <Party_4>, 'id': 'gen-nonce', 'label': 'Generate a new nonce $n_B$', 'line': 4, 'protocol': <Protocol_1>, '_counter': 4, 'node_name_counter': 1, '_affecting_nodes': ['Action_9_0'], 'node_name': 'Action_9_0', 'tex_id': '\\setcounter{protostep}{3}\\protostep{ns-attack:gen-nonce} ', 'tikz_extra_style': ''}


% drawing node of type GenericMessage in matrix line 5 with attributes: {'annexid': 'GenericMessage_10', 'src': <Party_4>, 'dest': <Party_3>, 'caption': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'id': 'nonces-bob-eve', 'line': 5, 'protocol': <Protocol_1>, '_counter': 5, 'text_above': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'text_below': '', '_affecting_nodes': ['pos-2-5', 'pos-1-5']}
%% draw message
            \draw[annex_message] (pos-2-5) to node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:nonces-bob-eve}](GenericMessage_10_0){\setcounter{protostep}{4}\protostep{ns-attack:nonces-bob-eve} \contour{white}{$\{n_A, n_B\}^\text{a}_{k_\text{Alice}}$}}  (pos-1-5); 

% drawing node of type GenericMessage in matrix line 6 with attributes: {'annexid': 'GenericMessage_11', 'src': <Party_3>, 'dest': <Party_2>, 'caption': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'line': 6, 'protocol': <Protocol_1>, '_counter': 6, 'text_above': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'text_below': '', '_affecting_nodes': ['pos-1-6', 'pos-0-6']}
%% draw message
            \draw[annex_message] (pos-1-6) to node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_11_0){\setcounter{protostep}{5}\protostep{ns-attack:GenericMessage_11} \contour{white}{$\{n_A, n_B\}^\text{a}_{k_\text{Alice}}$}}  (pos-0-6); 

% drawing node of type GenericMessage in matrix line 7 with attributes: {'annexid': 'GenericMessage_12', 'src': <Party_2>, 'dest': <Party_3>, 'caption': '$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$', 'line': 7, 'protocol': <Protocol_1>, '_counter': 7, 'text_above': '$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$', 'text_below': '', '_affecting_nodes': ['pos-0-7', 'pos-1-7']}
%% draw message
            \draw[annex_message] (pos-0-7) to node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_12_0){\setcounter{protostep}{6}\protostep{ns-attack:GenericMessage_12} \contour{white}{$\{n_B\}^\text{a}_{k_\text{Eve}}$}}  (pos-1-7); 

% drawing node of type GenericMessage in matrix line 8 with attributes: {'annexid': 'GenericMessage_13', 'src': <Party_3>, 'dest': <Party_4>, 'caption': '$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$', 'line': 8, 'protocol': <Protocol_1>, '_counter': 8, 'text_above': '$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$', 'text_below': '', '_affecting_nodes': ['pos-1-8', 'pos-2-8']}
%% draw message
            \draw[annex_message] (pos-1-8) to node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_13_0){\setcounter{protostep}{7}\protostep{ns-attack:GenericMessage_13} \contour{white}{$\{n_B\}^\text{a}_{k_\text{Bob}}$}}  (pos-2-8); 

% drawing node of type Parallel in matrix line 9 with attributes: {'annexid': 'Parallel_14', 'steps': [<EndParty_18>, <EndParty_19>, <EndParty_20>], 'line': 9, 'length': 1, 'protocol': <Protocol_1>}


% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_18', 'party': <Party_2>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_18_0'], 'node_name': 'EndParty_18_0'}


% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_19', 'party': <Party_4>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_19_0'], 'node_name': 'EndParty_19_0'}


% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_20', 'party': <Party_3>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_20_0'], 'node_name': 'EndParty_20_0'}


\end{pgfonlayer}
% MARKERS LAYER

\begin{pgfonlayer}{markers}% drawing node of type Protocol in matrix line 0 with attributes: {'annexid': 'Protocol_1', 'parties': [<Party_2>, <Party_3>, <Party_4>], 'steps': [<Parallel_5>, <Action_6>, <GenericMessage_7>, <GenericMessage_8>, <Action_9>, <GenericMessage_10>, <GenericMessage_11>, <GenericMessage_12>, <GenericMessage_13>, <Parallel_14>], 'options': {'colsep': '0.3\\linewidth', 'rowsep': '0.25ex', 'enumerate': '\\setcounter{protostep}{%d}\\protostep{ns-attack:%s} ', 'styles': [], 'tex_intro': ''}, 'line': 0, 'length': 10, 'columns': [{'num': 0}, {'num': 1}, {'num': 2}], 'protocol': <Protocol_1>}



% drawing node of type Parallel in matrix line 0 with attributes: {'annexid': 'Parallel_5', 'steps': [<StartParty_15>, <StartParty_16>, <StartParty_17>], 'line': 0, 'length': 1, 'protocol': <Protocol_1>}



% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_15', 'party': <Party_2>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_15_0'], 'node_name': 'StartParty_15_0', 'end': <EndParty_18>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}



% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_16', 'party': <Party_3>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_16_0'], 'node_name': 'StartParty_16_0', 'end': <EndParty_20>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}



% drawing node of type StartParty in matrix line 0 with attributes: {'annexid': 'StartParty_17', 'party': <Party_4>, 'line': 0, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['StartParty_17_0'], 'node_name': 'StartParty_17_0', 'end': <EndParty_19>, 'lifeline_segments': [(0, 18, 'annex_lifeline')]}



% drawing node of type Action in matrix line 1 with attributes: {'annexid': 'Action_6', 'party': <Party_2>, 'id': 'gen-nonce', 'label': 'Generate a new nonce $n_A$', 'line': 1, 'protocol': <Protocol_1>, '_counter': 1, 'node_name_counter': 1, '_affecting_nodes': ['Action_6_0'], 'node_name': 'Action_6_0', 'tex_id': '\\setcounter{protostep}{0}\\protostep{ns-attack:gen-nonce} ', 'tikz_extra_style': ''}



% drawing node of type GenericMessage in matrix line 2 with attributes: {'annexid': 'GenericMessage_7', 'src': <Party_2>, 'dest': <Party_3>, 'caption': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$', 'id': 'msg1-a-e', 'line': 2, 'protocol': <Protocol_1>, '_counter': 2, 'text_above': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$', 'text_below': '', '_affecting_nodes': ['pos-0-2', 'pos-1-2', 'GenericMessage_7_0'], 'tikz_extra_style': '', 'node_name_counter': 1, 'tex_id': '\\setcounter{protostep}{1}\\protostep{ns-attack:msg1-a-e} ', 'tikz_above': 'node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:msg1-a-e}](GenericMessage_7_0){\\setcounter{protostep}{1}\\protostep{ns-attack:msg1-a-e} \\contour{white}{$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Eve}}$}}', 'tikz_below': ''}



% drawing node of type GenericMessage in matrix line 3 with attributes: {'annexid': 'GenericMessage_8', 'src': <Party_3>, 'dest': <Party_4>, 'caption': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$', 'line': 3, 'protocol': <Protocol_1>, '_counter': 3, 'text_above': '$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$', 'text_below': '', '_affecting_nodes': ['pos-1-3', 'pos-2-3', 'GenericMessage_8_0'], 'tikz_extra_style': '', 'node_name_counter': 1, 'tex_id': '\\setcounter{protostep}{2}\\protostep{ns-attack:GenericMessage_8} ', 'tikz_above': 'node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_8_0){\\setcounter{protostep}{2}\\protostep{ns-attack:GenericMessage_8} \\contour{white}{$\\{\\text{Alice}, n_A\\}^\\text{a}_{k_\\text{Bob}}$}}', 'tikz_below': ''}



% drawing node of type Action in matrix line 4 with attributes: {'annexid': 'Action_9', 'party': <Party_4>, 'id': 'gen-nonce', 'label': 'Generate a new nonce $n_B$', 'line': 4, 'protocol': <Protocol_1>, '_counter': 4, 'node_name_counter': 1, '_affecting_nodes': ['Action_9_0'], 'node_name': 'Action_9_0', 'tex_id': '\\setcounter{protostep}{3}\\protostep{ns-attack:gen-nonce} ', 'tikz_extra_style': ''}



% drawing node of type GenericMessage in matrix line 5 with attributes: {'annexid': 'GenericMessage_10', 'src': <Party_4>, 'dest': <Party_3>, 'caption': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'id': 'nonces-bob-eve', 'line': 5, 'protocol': <Protocol_1>, '_counter': 5, 'text_above': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'text_below': '', '_affecting_nodes': ['pos-2-5', 'pos-1-5', 'GenericMessage_10_0'], 'tikz_extra_style': '', 'node_name_counter': 1, 'tex_id': '\\setcounter{protostep}{4}\\protostep{ns-attack:nonces-bob-eve} ', 'tikz_above': 'node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:nonces-bob-eve}](GenericMessage_10_0){\\setcounter{protostep}{4}\\protostep{ns-attack:nonces-bob-eve} \\contour{white}{$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$}}', 'tikz_below': ''}



% drawing node of type GenericMessage in matrix line 6 with attributes: {'annexid': 'GenericMessage_11', 'src': <Party_3>, 'dest': <Party_2>, 'caption': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'line': 6, 'protocol': <Protocol_1>, '_counter': 6, 'text_above': '$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$', 'text_below': '', '_affecting_nodes': ['pos-1-6', 'pos-0-6', 'GenericMessage_11_0'], 'tikz_extra_style': '', 'node_name_counter': 1, 'tex_id': '\\setcounter{protostep}{5}\\protostep{ns-attack:GenericMessage_11} ', 'tikz_above': 'node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_11_0){\\setcounter{protostep}{5}\\protostep{ns-attack:GenericMessage_11} \\contour{white}{$\\{n_A, n_B\\}^\\text{a}_{k_\\text{Alice}}$}}', 'tikz_below': ''}



% drawing node of type GenericMessage in matrix line 7 with attributes: {'annexid': 'GenericMessage_12', 'src': <Party_2>, 'dest': <Party_3>, 'caption': '$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$', 'line': 7, 'protocol': <Protocol_1>, '_counter': 7, 'text_above': '$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$', 'text_below': '', '_affecting_nodes': ['pos-0-7', 'pos-1-7', 'GenericMessage_12_0'], 'tikz_extra_style': '', 'node_name_counter': 1, 'tex_id': '\\setcounter{protostep}{6}\\protostep{ns-attack:GenericMessage_12} ', 'tikz_above': 'node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_12_0){\\setcounter{protostep}{6}\\protostep{ns-attack:GenericMessage_12} \\contour{white}{$\\{n_B\\}^\\text{a}_{k_\\text{Eve}}$}}', 'tikz_below': ''}



% drawing node of type GenericMessage in matrix line 8 with attributes: {'annexid': 'GenericMessage_13', 'src': <Party_3>, 'dest': <Party_4>, 'caption': '$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$', 'line': 8, 'protocol': <Protocol_1>, '_counter': 8, 'text_above': '$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$', 'text_below': '', '_affecting_nodes': ['pos-1-8', 'pos-2-8', 'GenericMessage_13_0'], 'tikz_extra_style': '', 'node_name_counter': 1, 'tex_id': '\\setcounter{protostep}{7}\\protostep{ns-attack:GenericMessage_13} ', 'tikz_above': 'node [annex_arrow_text,above=5pt,anchor=base,pin={[pin distance=-8pt,pin edge={draw=none},annex_debug]90:}](GenericMessage_13_0){\\setcounter{protostep}{7}\\protostep{ns-attack:GenericMessage_13} \\contour{white}{$\\{n_B\\}^\\text{a}_{k_\\text{Bob}}$}}', 'tikz_below': ''}



% drawing node of type Parallel in matrix line 9 with attributes: {'annexid': 'Parallel_14', 'steps': [<EndParty_18>, <EndParty_19>, <EndParty_20>], 'line': 9, 'length': 1, 'protocol': <Protocol_1>}



% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_18', 'party': <Party_2>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_18_0'], 'node_name': 'EndParty_18_0'}



% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_19', 'party': <Party_4>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_19_0'], 'node_name': 'EndParty_19_0'}



% drawing node of type EndParty in matrix line 9 with attributes: {'annexid': 'EndParty_20', 'party': <Party_3>, 'line': 9, 'protocol': <Protocol_1>, 'node_name_counter': 1, '_affecting_nodes': ['EndParty_20_0'], 'node_name': 'EndParty_20_0'}



\end{pgfonlayer}
        \end{tikzpicture}
        